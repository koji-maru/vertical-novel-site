<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¸¦æ›¸ãå°èª¬ã‚µã‚¤ãƒˆ</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@400;500;600&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Noto Serif JP', serif;
            background: linear-gradient(135deg, #f5f3f0 0%, #e8e2db 100%);
            min-height: 100vh;
            color: #2c2c2c;
            overflow-x: auto;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            border-bottom: 3px solid #d4af37;
        }
        
        .site-title {
            font-size: 2.5rem;
            font-weight: 600;
            color: #8b4513;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .subtitle {
            font-size: 1.1rem;
            color: #666;
            font-weight: 400;
        }
        

        .controls {
            background: rgba(255, 255, 255, 0.8);
            padding: 15px;
            text-align: center;
            margin-top: 120px;
            margin-bottom: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(5px);
        }
        
        .btn {
            background: linear-gradient(135deg, #8b4513, #a0522d);
            color: white;
            border: none;
            padding: 12px 24px;
            margin: 5px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-family: inherit;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(139, 69, 19, 0.3);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(139, 69, 19, 0.4);
            background: linear-gradient(135deg, #a0522d, #8b4513);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .novel-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            margin-bottom: 40px;
            margin-top: 140px;
        }
        
        .novel-content {
            writing-mode: vertical-rl;
            text-orientation: mixed;
            height: 600px;
            overflow-x: auto;
            overflow-y: hidden;
            padding: 40px;
            line-height: 2.2;
            font-size: 1.1rem;
            letter-spacing: 0.1em;
            background: linear-gradient(45deg, #fefefe, #f9f9f9);
            border-radius: 10px;
            border: 2px solid #e8e2db;
            position: relative;
        }
        
        .novel-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                repeating-linear-gradient(
                    to bottom,
                    transparent,
                    transparent 2.4em,
                    rgba(139, 69, 19, 0.1) 2.4em,
                    rgba(139, 69, 19, 0.1) 2.5em
                );
            pointer-events: none;
            border-radius: 8px;
        }
        
        .novel-content p {
            margin-bottom: 1.5em;
            text-indent: 1em;
            position: relative;
            z-index: 1;
        }
        
        .novel-content h2 {
            font-size: 1.4rem;
            font-weight: 600;
            margin-bottom: 2em;
            color: #8b4513;
            border-right: 3px solid #d4af37;
            padding-right: 15px;
            position: relative;
            z-index: 1;
        }
        
        .chapter-nav {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 10px;
            backdrop-filter: blur(5px);
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .scroll-hint {
            text-align: center;
            color: #888;
            font-size: 0.9rem;
            margin-top: 15px;
            animation: fade 2s ease-in-out infinite alternate;
        }
        
        @keyframes fade {
            from { opacity: 0.5; }
            to { opacity: 1; }
        }
        
        .upload-area {
            border: 2px dashed #d4af37;
            border-radius: 10px;
            padding: 40px;
            text-align: center;
            margin-bottom: 20px;
            background: rgba(255, 255, 255, 0.5);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .upload-area:hover {
            border-color: #8b4513;
            background: rgba(255, 255, 255, 0.7);
        }
        
        .upload-area.dragover {
            border-color: #8b4513;
            background: rgba(139, 69, 19, 0.1);
        }
        
        .file-input {
            display: none;
        }
        
    .novel-content {
                height: 400px;
                padding: 20px;
                font-size: 1rem;
            }
            
            .site-title {
                font-size: 2rem;
            }
            
            .reader-controls {
                margin-top: 100px;
            }
            
            .controls {
                margin-top: 100px;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <h1 class="site-title">ç¸¦æ›¸ãå°èª¬é¤¨</h1>
        <p class="subtitle">ã‚ãªãŸã®ç‰©èªã‚’ç¾ã—ã„ç¸¦æ›¸ãã§</p>
    </header>
    
    <!-- ç·¨é›†æ©Ÿèƒ½ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§éè¡¨ç¤ºï¼‰ -->
    <div class="controls" id="editControls" style="display: none;">
        <button class="btn" onclick="toggleEditMode()">ç·¨é›†ãƒ¢ãƒ¼ãƒ‰</button>
        <button class="btn" onclick="addChapter()">ç« ã‚’è¿½åŠ </button>
        <button class="btn" onclick="exportNovel()">ä½œå“ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
        <button class="btn" onclick="importNovel()">ä½œå“ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ</button>
        <input type="file" id="fileInput" class="file-input" accept=".txt,.json" onchange="handleFileUpload(event)">
    </div>
    
    <div class="upload-area" id="uploadArea" onclick="document.getElementById('fileInput').click()" style="display: none;">
        <p>ğŸ“š ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã¾ãŸã¯ã‚¯ãƒªãƒƒã‚¯ã—ã¦å°èª¬ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</p>
        <p style="font-size: 0.9rem; color: #666; margin-top: 10px;">å¯¾å¿œå½¢å¼: .txt, .json</p>
    </div>
    

    
    <div class="novel-container">
        <div class="novel-content" id="novelContent" contenteditable="false">
            <h2>ç¬¬ä¸€ç« ã€€ã¯ã˜ã¾ã‚Šã®é¢¨</h2>
            <p>æ˜¥ã®é™½ã ã¾ã‚Šã«åŒ…ã¾ã‚ŒãŸå°ã•ãªç”ºã§ã€ä¸€äººã®å°‘å¥³ãŒç©ºã‚’è¦‹ä¸Šã’ã¦ã„ãŸã€‚é›²ãŒã‚†ã£ãã‚Šã¨æµã‚Œã¦ã„ãæ§˜å­ã‚’çœºã‚ãªãŒã‚‰ã€å½¼å¥³ã¯å¿ƒã®å¥¥åº•ã«çœ ã‚‹æƒ³ã„ã‚’æ„Ÿã˜ã¦ã„ãŸã€‚</p>
            <p>ã€Œä»Šæ—¥ã‚‚ã„ã„å¤©æ°—ã­ã€ã¨ã€éš£ã«åº§ã‚‹çŒ«ã«è©±ã—ã‹ã‘ã‚‹ã€‚çŒ«ã¯æŒ¯ã‚Šè¿”ã‚‹ã“ã¨ãªãã€ãŸã é™ã‹ã«å°»å°¾ã‚’æºã‚‰ã™ã ã‘ã ã£ãŸã€‚</p>
            <p>é¢¨ãŒé ¬ã‚’æ’«ã§ã¦ã„ãã€‚ã“ã®ç©ã‚„ã‹ãªæ™‚é–“ãŒæ°¸é ã«ç¶šã‘ã°ã„ã„ã®ã«ã€ã¨å½¼å¥³ã¯æ€ã£ãŸã€‚ã—ã‹ã—ã€é‹å‘½ã®æ­¯è»Šã¯æ—¢ã«å›ã‚Šå§‹ã‚ã¦ã„ãŸã®ã§ã‚ã‚‹ã€‚</p>
            
            <h2>ç¬¬äºŒç« ã€€å‡ºä¼šã„ã®èª¿ã¹</h2>
            <p>ç”ºã®å›³æ›¸é¤¨ã§ã€å½¼å¥³ã¯ä¸€å†Šã®å¤ã„æœ¬ã¨å‡ºä¼šã£ãŸã€‚é©è£…ä¸ã®è¡¨ç´™ã«ã¯é‡‘è‰²ã®æ–‡å­—ã§ä½•ã‹ãŒæ›¸ã‹ã‚Œã¦ã„ã‚‹ãŒã€ãã‚Œã¯è¦‹ãŸã“ã¨ã®ãªã„æ–‡å­—ã ã£ãŸã€‚</p>
            <p>æœ¬ã‚’é–‹ãã¨ã€ä¸æ€è­°ãªé¦™ã‚ŠãŒæ¼‚ã£ã¦ããŸã€‚ãã‚Œã¯èŠ±ã®é¦™ã‚Šã§ã‚‚ãªãã€æœ¨ã®é¦™ã‚Šã§ã‚‚ãªã„ã€ã©ã“ã‹æ‡ã‹ã—ã„é¦™ã‚Šã ã£ãŸã€‚</p>
            <p>ã€Œã“ã‚Œã¯ä½•ã®æœ¬ã ã‚ã†ã€ã¨å‘ŸããªãŒã‚‰ã€å½¼å¥³ã¯ãƒšãƒ¼ã‚¸ã‚’ã‚ãã‚Šç¶šã‘ãŸã€‚ã™ã‚‹ã¨çªç„¶ã€æœ¬ã‹ã‚‰å…‰ãŒæº¢ã‚Œå‡ºã—ãŸã€‚</p>
        </div>
        
        <div class="scroll-hint">â† æ¨ªã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã—ã¦ç¶šãã‚’èª­ã‚€ â†’</div>
        
        <div class="chapter-nav">
            <button class="btn" onclick="previousChapter()">å‰ã®ç« </button>
            <button class="btn" onclick="nextChapter()">æ¬¡ã®ç« </button>
        </div>
    </div>



    <script>
        let isEditMode = false;
        let chapters = [];
        let currentChapter = 0;
        let editVisible = false;
        
        // åˆæœŸåŒ–
        function init() {
            const uploadArea = document.getElementById('uploadArea');
            
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });
            
            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('dragover');
            });
            
            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleFile(files[0]);
                }
            });
            
            // åˆæœŸã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ä¿å­˜
            saveCurrentContent();
        }
        
        function showEditOptions() {
            editVisible = !editVisible;
            const editControls = document.getElementById('editControls');
            const uploadArea = document.getElementById('uploadArea');
            const editToggle = document.getElementById('editToggle');
            
            if (editVisible) {
                editControls.style.display = 'block';
                uploadArea.style.display = 'block';
                editToggle.textContent = 'ğŸ‘ï¸ èª­ã‚€';
                editToggle.title = 'èª­è€…ãƒ¢ãƒ¼ãƒ‰ã«æˆ»ã‚‹';
            } else {
                editControls.style.display = 'none';
                uploadArea.style.display = 'none';
                editToggle.textContent = 'âœï¸ ç·¨é›†';
                editToggle.title = 'ç·¨é›†æ©Ÿèƒ½ã‚’è¡¨ç¤º';
                
                // ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã‚‚çµ‚äº†
                if (isEditMode) {
                    toggleEditMode();
                }
            }
        }
        
        function toggleFontSize() {
            const content = document.getElementById('novelContent');
            const indicator = document.getElementById('fontSizeIndicator');
            
            // ç¾åœ¨ã®ã‚¯ãƒ©ã‚¹ã‚’å‰Šé™¤
            content.classList.remove('large-font', 'small-font');
            
            if (currentFontSize === 'normal') {
                currentFontSize = 'large';
                content.classList.add('large-font');
                indicator.textContent = 'æ–‡å­—ã‚µã‚¤ã‚º: å¤§';
            } else if (currentFontSize === 'large') {
                currentFontSize = 'small';
                content.classList.add('small-font');
                indicator.textContent = 'æ–‡å­—ã‚µã‚¤ã‚º: å°';
            } else {
                currentFontSize = 'normal';
                indicator.textContent = 'æ–‡å­—ã‚µã‚¤ã‚º: æ¨™æº–';
            }
            
            // ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ã‚’è¡¨ç¤º
            indicator.classList.add('show');
            setTimeout(() => {
                indicator.classList.remove('show');
            }, 1500);
        }
        
        function toggleTheme() {
            const body = document.body;
            const indicator = document.getElementById('fontSizeIndicator');
            
            if (currentTheme === 'light') {
                currentTheme = 'dark';
                body.classList.add('dark-theme');
                indicator.textContent = 'ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰';
            } else {
                currentTheme = 'light';
                body.classList.remove('dark-theme');
                indicator.textContent = 'ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰';
            }
            
            // ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ã‚’è¡¨ç¤º
            indicator.classList.add('show');
            setTimeout(() => {
                indicator.classList.remove('show');
            }, 1500);
        }
            const content = document.getElementById('novelContent');
            isEditMode = !isEditMode;
            
            if (isEditMode) {
                content.contentEditable = true;
                content.style.border = '2px solid #d4af37';
                content.style.background = 'rgba(255, 255, 255, 0.95)';
            } else {
                content.contentEditable = false;
                content.style.border = '2px solid #e8e2db';
                content.style.background = 'linear-gradient(45deg, #fefefe, #f9f9f9)';
                saveCurrentContent();
            }
        }
        
        function saveCurrentContent() {
            const content = document.getElementById('novelContent').innerHTML;
            chapters[currentChapter] = content;
        }
        
        function addChapter() {
            saveCurrentContent();
            const newChapterContent = `
                <h2>ç¬¬${chapters.length + 1}ç« ã€€æ–°ã—ã„ç« </h2>
                <p>ã“ã“ã«æ–°ã—ã„ç« ã®å†…å®¹ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚</p>
            `;
            chapters.push(newChapterContent);
            currentChapter = chapters.length - 1;
            document.getElementById('novelContent').innerHTML = newChapterContent;
        }
        
        function previousChapter() {
            if (currentChapter > 0) {
                saveCurrentContent();
                currentChapter--;
                document.getElementById('novelContent').innerHTML = chapters[currentChapter];
            }
        }
        
        function nextChapter() {
            if (currentChapter < chapters.length - 1) {
                saveCurrentContent();
                currentChapter++;
                document.getElementById('novelContent').innerHTML = chapters[currentChapter];
            }
        }
        
        function exportNovel() {
            saveCurrentContent();
            const novelData = {
                title: document.querySelector('.site-title').textContent,
                chapters: chapters,
                createdAt: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(novelData, null, 2)], {
                type: 'application/json'
            });
            
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'novel_' + new Date().toISOString().split('T')[0] + '.json';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        function importNovel() {
            document.getElementById('fileInput').click();
        }
        
        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (file) {
                handleFile(file);
            }
        }
        
        function handleFile(file) {
            const reader = new FileReader();
            
            reader.onload = function(e) {
                const content = e.target.result;
                
                if (file.name.endsWith('.json')) {
                    try {
                        const novelData = JSON.parse(content);
                        if (novelData.chapters) {
                            chapters = novelData.chapters;
                            currentChapter = 0;
                            document.getElementById('novelContent').innerHTML = chapters[0];
                            
                            if (novelData.title) {
                                document.querySelector('.site-title').textContent = novelData.title;
                            }
                        }
                    } catch (error) {
                        alert('JSONãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚');
                    }
                } else if (file.name.endsWith('.txt')) {
                    // ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç« ã”ã¨ã«åˆ†å‰²
                    const text = content;
                    const chapterSections = text.split(/ç¬¬\d+ç« |ç« \d+/).filter(section => section.trim());
                    
                    if (chapterSections.length > 1) {
                        chapters = chapterSections.map((section, index) => {
                            const paragraphs = section.trim().split('\n\n').map(p => 
                                p.trim() ? `<p>${p.trim()}</p>` : ''
                            ).filter(p => p);
                            
                            return `<h2>ç¬¬${index + 1}ç« </h2>\n${paragraphs.join('\n')}`;
                        });
                    } else {
                        // ç« åˆ†ã‘ã•ã‚Œã¦ã„ãªã„å ´åˆã¯æ®µè½ã§åˆ†å‰²
                        const paragraphs = text.split('\n\n').map(p => 
                            p.trim() ? `<p>${p.trim()}</p>` : ''
                        ).filter(p => p);
                        
                        chapters = [`<h2>ç¬¬ä¸€ç« </h2>\n${paragraphs.join('\n')}`];
                    }
                    
                    currentChapter = 0;
                    document.getElementById('novelContent').innerHTML = chapters[0];
                }
            };
            
            reader.readAsText(file, 'UTF-8');
        }
        
        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«åˆæœŸåŒ–
        window.addEventListener('load', init);
    </script>
</body>
</html>
